# é£ä¹¦è®¤è¯æ¨¡å—

> åŸºäºé£ä¹¦å¤šç»´è¡¨æ ¼çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼Œä¸“ä¸ºå¿«é€Ÿé›†æˆåˆ°å…¶ä»–åº”ç”¨è€Œè®¾è®¡

![Next.js](https://img.shields.io/badge/Next.js-14-black)
![TypeScript](https://img.shields.io/badge/TypeScript-5.3-blue)
![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.3-38bdf8)
![é£ä¹¦API](https://img.shields.io/badge/é£ä¹¦API-æ”¯æŒ-00d4aa)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” **æ™ºèƒ½è®¤è¯**ï¼šè‡ªåŠ¨æ£€æµ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œæ–°ç”¨æˆ·è‡ªåŠ¨æ³¨å†Œï¼Œè€ç”¨æˆ·ç›´æ¥ç™»å½•
- ğŸ“± **ç§»åŠ¨ä¼˜å…ˆ**ï¼šå“åº”å¼è®¾è®¡ï¼Œå®Œç¾é€‚é…æ‰‹æœºå’Œæ¡Œé¢ç«¯
- ğŸš€ **æ˜“äºé›†æˆ**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œå¯å¿«é€Ÿé›†æˆåˆ°å…¶ä»–Next.jsåº”ç”¨
- ğŸ”’ **æ•°æ®å®‰å…¨**ï¼šæ‰€æœ‰ç”¨æˆ·æ•°æ®å®‰å…¨å­˜å‚¨åœ¨é£ä¹¦å¤šç»´è¡¨æ ¼ä¸­
- âš¡ **æ€§èƒ½ä¼˜åŒ–**ï¼šåŸºäºNext.js 14 App Routerï¼Œæ”¯æŒSSRå’Œç¼“å­˜ä¼˜åŒ–
- ğŸ› ï¸ **TypeScript**ï¼šå®Œæ•´ç±»å‹æ”¯æŒï¼Œå¼€å‘ä½“éªŒæ›´å¥½

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
feishu-auth-module/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/auth/          # è®¤è¯APIè·¯ç”±
â”‚   â”œâ”€â”€ page.tsx           # ç™»å½•/æ³¨å†Œé¡µé¢
â”‚   â”œâ”€â”€ layout.tsx         # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ globals.css        # å…¨å±€æ ·å¼
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ feishu.ts          # é£ä¹¦APIæœåŠ¡
â”œâ”€â”€ env.template           # ç¯å¢ƒå˜é‡æ¨¡æ¿
â””â”€â”€ README.md              # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒå·²å®‰è£…ï¼š
- Node.js 18+
- npm 9+

### 2. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-username/feishu-auth-module.git
cd feishu-auth-module
```

### 3. å®‰è£…ä¾èµ–

```bash
npm install
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿å¹¶å¡«å…¥ä½ çš„é£ä¹¦åº”ç”¨ä¿¡æ¯ï¼š

```bash
cp env.template .env.local
```

åœ¨ `.env.local` ä¸­å¡«å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š

```env
# é£ä¹¦åº”ç”¨é…ç½®
FEISHU_APP_ID=your_app_id
FEISHU_APP_SECRET=your_app_secret

# é£ä¹¦å¤šç»´è¡¨æ ¼é…ç½®
FEISHU_USER_TABLE_APP_TOKEN=your_table_app_token
FEISHU_USER_TABLE_ID=your_user_table_id
```

### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—® http://localhost:3000 æŸ¥çœ‹è®¤è¯æ¨¡å—ã€‚

## ğŸ“‹ é£ä¹¦é…ç½®

### 1. åˆ›å»ºé£ä¹¦åº”ç”¨

1. è®¿é—® [é£ä¹¦å¼€æ”¾å¹³å°](https://open.feishu.cn/)
2. åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨
3. è·å– App ID å’Œ App Secret

### 2. é…ç½®æƒé™

ä¸ºåº”ç”¨æ·»åŠ ä»¥ä¸‹æƒé™ï¼š
- `bitable:app` - å¤šç»´è¡¨æ ¼åº”ç”¨æƒé™
- `bitable:app:read` - è¯»å–å¤šç»´è¡¨æ ¼
- `bitable:app:write` - å†™å…¥å¤šç»´è¡¨æ ¼

### 3. åˆ›å»ºç”¨æˆ·è¡¨

åœ¨é£ä¹¦å¤šç»´è¡¨æ ¼ä¸­åˆ›å»ºç”¨æˆ·è¡¨ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå | å­—æ®µç±»å‹ | è¯´æ˜ |
|--------|----------|------|
| æ‰‹æœºå· | å•è¡Œæ–‡æœ¬ | ç”¨æˆ·æ‰‹æœºå·ï¼ˆä¸»é”®ï¼‰ |
| å§“å | å•è¡Œæ–‡æœ¬ | ç”¨æˆ·å§“å |
| ç”¨æˆ·ç±»å‹ | å•é€‰ | è€å¸ˆ/å®¶é•¿/ç®¡ç†å‘˜ |
| åˆ›å»ºæ—¶é—´ | æ—¥æœŸæ—¶é—´ | è´¦æˆ·åˆ›å»ºæ—¶é—´ |
| æœ€åç™»å½•æ—¶é—´ | æ—¥æœŸæ—¶é—´ | æœ€åç™»å½•æ—¶é—´ |
| çŠ¶æ€ | å•é€‰ | æ­£å¸¸/ç¦ç”¨ |

## ğŸ”Œ API æ¥å£

### POST /api/auth

ç”¨æˆ·è®¤è¯æ¥å£ï¼Œæ”¯æŒç™»å½•å’Œæ³¨å†Œã€‚

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "phone": "13800138000",
  "name": "å¼ ä¸‰",
  "userType": "è€å¸ˆ"
}
```

**å“åº”æ ¼å¼ï¼š**
```json
{
  "success": true,
  "user": {
    "id": "rec123456",
    "phone": "13800138000", 
    "name": "å¼ ä¸‰",
    "userType": "è€å¸ˆ",
    "createdTime": "2025-01-01T00:00:00Z",
    "lastLoginTime": "2025-01-01T00:00:00Z"
  },
  "isNewUser": false
}
```

## ğŸ§© é›†æˆåˆ°å…¶ä»–åº”ç”¨

### 1. å¤åˆ¶æ ¸å¿ƒæ–‡ä»¶

å°†ä»¥ä¸‹æ–‡ä»¶å¤åˆ¶åˆ°ä½ çš„Next.jsé¡¹ç›®ï¼š
- `lib/feishu.ts` - é£ä¹¦APIæœåŠ¡
- `app/api/auth/route.ts` - è®¤è¯API

### 2. ä½¿ç”¨è®¤è¯æœåŠ¡

```typescript
import { feishuService } from '@/lib/feishu';

// ç”¨æˆ·è®¤è¯
const result = await feishuService.authenticateUser(
  phone, 
  name, 
  userType
);

if (result.user) {
  console.log('è®¤è¯æˆåŠŸ:', result.user);
  console.log('æ˜¯å¦æ–°ç”¨æˆ·:', result.isNewUser);
}
```

### 3. å‰ç«¯é›†æˆ

```typescript
// å‘é€è®¤è¯è¯·æ±‚
const response = await fetch('/api/auth', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ phone, name, userType })
});

const data = await response.json();
```

## ğŸ¨ è‡ªå®šä¹‰æ ·å¼

æœ¬é¡¹ç›®ä½¿ç”¨ Tailwind CSSï¼Œä½ å¯ä»¥ï¼š

1. ä¿®æ”¹ `app/globals.css` è°ƒæ•´å…¨å±€æ ·å¼
2. ä¿®æ”¹ `app/page.tsx` è‡ªå®šä¹‰ç™»å½•é¡µé¢æ ·å¼
3. æ›´æ–° `tailwind.config.js` æ·»åŠ è‡ªå®šä¹‰ä¸»é¢˜

## ğŸ“¦ æ„å»ºéƒ¨ç½²

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
```

### éƒ¨ç½²åˆ°Vercel

1. å°†ä»£ç æ¨é€åˆ°GitHub
2. åœ¨Vercelä¸­å¯¼å…¥é¡¹ç›®
3. é…ç½®ç¯å¢ƒå˜é‡
4. ä¸€é”®éƒ¨ç½²

## ğŸ”§ å¼€å‘

### ç±»å‹æ£€æŸ¥

```bash
npm run type-check
```

### ä»£ç è§„èŒƒ

```bash
npm run lint
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-06-30)

- âœ¨ ç®€åŒ–é¡¹ç›®ç»“æ„ï¼Œä¸“æ³¨è®¤è¯åŠŸèƒ½
- ğŸ” å®Œå–„çš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–ç•Œé¢
- ğŸ› ï¸ å®Œæ•´çš„TypeScriptæ”¯æŒ
- ğŸ“š è¯¦ç»†çš„é›†æˆæ–‡æ¡£

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

[MIT License](LICENSE)

## ğŸ™‹â€â™‚ï¸ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æœ¬æ–‡æ¡£
2. æäº¤ GitHub Issue
3. è”ç³»å¼€å‘è€…

---

**âœ¨ è¿™æ˜¯ä¸€ä¸ªä¸“æ³¨ã€å¯é çš„é£ä¹¦è®¤è¯æ¨¡å—ï¼ŒåŠ©åŠ›ä½ çš„åº”ç”¨å¿«é€Ÿå®ç°ç”¨æˆ·ç®¡ç†åŠŸèƒ½ï¼** 